<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Manage Products</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
    }

    header {
      background-color: #4CAF50;
      color: white;
      padding: 1rem;
      text-align: center;
    }

    nav {
      display: flex;
      justify-content: center;
      background-color: #333;
    }

    nav a {
      color: white;
      padding: 1rem;
      text-decoration: none;
    }

    nav a:hover {
      background-color: #ddd;
      color: black;
    }

    .container {
      width: 90%;
      margin: 20px auto;
      background-color: #fff;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    table th,
    table td {
      border: 1px solid #ddd;
      padding: 8px;
    }

    table th {
      background-color: #f4f4f4;
    }

    input,
    select,
    textarea {
      width: 100%;
      padding: 5px;
      box-sizing: border-box;
    }

    .actions button {
      margin-right: 5px;
      padding: 5px 10px;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }

    .actions button.delete {
      background-color: #f44336;
    }

    .product-image {
      max-width: 80px;
      max-height: 80px;
      object-fit: cover;
    }

    .announcements-section {
      margin-top: 40px;
    }

    .announcement-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid #ddd;
    }

    .announcement-actions {
      display: flex;
      gap: 5px;
    }
  </style>
</head>

<body>
  <header>
    <h1>Admin - Manage Products</h1>
  </header>

  <nav>
    <a href="home.html">Home</a>
    <a href="volunteer.html">Volunteer Sheet</a>
    <a href="admin.html">Admin Login</a>
    <a href="checkout.html">Checkout</a>
    <a href="products.html">Products</a>
  </nav>

  <div class="container">
    <h2>Manage Products</h2>
    <table>
      <thead>
        <tr>
          <th>Product Name</th>
          <th>Price</th>
          <th>Category</th>
          <th>Stock</th>
          <th>Description</th>
          <th>Date</th>
          <th>New/Edit</th>
          <th>Image</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="product-list"></tbody>
    </table>
    <div>
      <h3>Add/Edit Product</h3>
      <div class="form-group">
        <label for="product-name">Product Name</label>
        <input type="text" id="product-name" />
      </div>
      <div class="form-group">
        <label for="product-price">Price</label>
        <input type="number" id="product-price" />
      </div>
      <div class="form-group">
        <label for="product-stock">Stock</label>
        <input type="number" id="product-stock" />
      </div>
      <div class="form-group">
        <label for="product-description">Description</label>
        <textarea id="product-description"></textarea>
      </div>
      <div class="form-group">
        <label for="product-category">Category</label>
        <select id="product-category">
          <option value="Snacks">Snacks</option>
          <option value="Drinks">Drinks</option>
          <option value="School Supplies">School Supplies</option>
          <option value="Miscellaneous">Miscellaneous</option>
          <option value="Apparel">Apparel</option>
        </select>
      </div>
      <div class="form-group">
        <label for="product-image">Image</label>
        <input type="file" id="product-image" accept="image/*" />
      </div>
      <button onclick="saveProduct()">Save Product</button>
    </div>

    <div class="announcements-section">
      <h2>Manage Announcements</h2>
      <div>
        <h3>Add Announcement</h3>
        <div class="form-group">
          <label for="announcement-title">Title</label>
          <input type="text" id="announcement-title" />
        </div>
        <div class="form-group">
          <label for="announcement-date">Date</label>
          <input type="date" id="announcement-date" />
        </div>
        <div class="form-group">
          <label for="announcement-description">Description</label>
          <textarea id="announcement-description"></textarea>
        </div>
        <button onclick="saveAnnouncement()">Save Announcement</button>
      </div>

      <div>
        <h3>Current Announcements</h3>
        <div id="announcement-list"></div>
      </div>
    </div>
  </div>

  <script>
    let products = [];
    let announcements = [];
    let editingIndex = -1;
    let editingAnnouncementIndex = -1;

    window.onload = loadData;

    function loadData() {
      // Load existing products and announcements (simulated for now)
      products = JSON.parse(localStorage.getItem('products') || '[]');
      announcements = JSON.parse(localStorage.getItem('announcements') || '[]');

      displayProducts();
      displayAnnouncements();
    }

    function displayProducts() {
      const productList = document.getElementById("product-list");
      productList.innerHTML = "";

      products.forEach((product, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${product.name}</td>
          <td>$${product.price}</td>
          <td>${product.category}</td>
          <td>${product.stock || "N/A"}</td>
          <td>${product.description || "N/A"}</td>
          <td>${product.date || "N/A"}</td>
          <td>${product.newOrEdit || "N/A"}</td>
          <td>${product.image ? `<img src="${product.image}" class="product-image" alt="${product.name}" />` : "No image"}</td>
          <td class="actions">
            <button onclick="startEdit(${index})">Edit</button>
            <button class="delete" onclick="deleteProduct(${index})">Delete</button>
          </td>
        `;
        productList.appendChild(row);
      });
    }

    function displayAnnouncements() {
      const announcementList = document.getElementById("announcement-list");
      announcementList.innerHTML = "";

      announcements.forEach((announcement, index) => {
        const announcementDiv = document.createElement("div");
        announcementDiv.classList.add("announcement-item");
        announcementDiv.innerHTML = `
          <span><strong>${announcement.title}</strong> - ${announcement.date}</span>
          <div class="announcement-actions">
            <button onclick="startEditAnnouncement(${index})">Edit</button>
            <button class="delete" onclick="deleteAnnouncement(${index})">Delete</button>
          </div>
        `;
        announcementList.appendChild(announcementDiv);
      });
    }

    function saveProduct() {
      const name = document.getElementById("product-name").value.trim();
      const price = parseFloat(document.getElementById("product-price").value);
      const stock = parseInt(document.getElementById("product-stock").value, 10);
      const description = document.getElementById("product-description").value.trim();
      const category = document.getElementById("product-category").value;
      const imageFile = document.getElementById("product-image").files[0];
      const date = new Date().toISOString().split("T")[0]; // Current date
      const newOrEdit = editingIndex === -1 ? "New" : "Edit";

      if (!name || isNaN(price) || isNaN(stock) || !category || !description) {
        alert("Please fill in all fields correctly.");
        return;
      }

      const imageUrl = imageFile ? URL.createObjectURL(imageFile) : null;

      const productData = {
        name,
        price,
        stock,
        description,
        category,
        date,
        newOrEdit,
        image: imageUrl || "",
      };

      if (editingIndex === -1) {
        products.push(productData);
      } else {
        products[editingIndex] = productData;
        editingIndex = -1;
      }

      // Save to localStorage
      localStorage.setItem('products', JSON.stringify(products));

      displayProducts();
    }

    function saveAnnouncement() {
      const title = document.getElementById("announcement-title").value.trim();
      const date = document.getElementById("announcement-date").value;
      const description = document.getElementById("announcement-description").value.trim();

      if (!title || !date || !description) {
        alert("Please fill in all fields.");
        return;
      }

      const announcementData = {
        title,
        date,
        description,
      };

      if (editingAnnouncementIndex === -1) {
        announcements.push(announcementData);
      } else {
        announcements[editingAnnouncementIndex] = announcementData;
        editingAnnouncementIndex = -1;
      }

      // Save to localStorage
      localStorage.setItem('announcements', JSON.stringify(announcements));

      displayAnnouncements();
    }

    function deleteProduct(index) {
      if (confirm("Are you sure you want to delete this product?")) {
        products.splice(index, 1);
        localStorage.setItem('products', JSON.stringify(products));
        displayProducts();
      }
    }

    function deleteAnnouncement(index) {
      if (confirm("Are you sure you want to delete this announcement?")) {
        announcements.splice(index, 1);
        localStorage.setItem('announcements', JSON.stringify(announcements));
        displayAnnouncements();
      }
    }

    function startEdit(index) {
      editingIndex = index;
      const product = products[index];
      document.getElementById("product-name").value = product.name;
      document.getElementById("product-price").value = product.price;
      document.getElementById("product-stock").value = product.stock;
      document.getElementById("product-description").value = product.description;
      document.getElementById("product-category").value = product.category;
    }

    function startEditAnnouncement(index) {
      editingAnnouncementIndex = index;
      const announcement = announcements[index];
      document.getElementById("announcement-title").value = announcement.title;
      document.getElementById("announcement-date").value = announcement.date;
      document.getElementById("announcement-description").value = announcement.description;
    }
  </script>
</body>

</html>
